<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Search Engine
Implement the simplified Search Engine for the pages of a small Web site. Use all the words in the pages of the site as index terms, exc">
    

    <!--Author-->
    
        <meta name="author" content="Shaohua Shang">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Search Engine"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Hi, I&#39;m Shaohua Shang"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>Search Engine - Hi, I&#39;m Shaohua Shang</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-108611056-1', 'auto');
        ga('send', 'pageview');

    </script>



    <!-- favicon -->
    
    <link rel="icon" href="img/tomcat.ico">
    
	
</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Shaohua Shang</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/About-Me">
                            
                                ABOUT ME
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/What-I-Do">
                            
                                WHAT I DO
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/My-Education">
                            
                                MY EDUCATION
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/shaohuashang3">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('https://images.unsplash.com/photo-1487017159836-4e23ece2e4cf?w=2551&ixid=dW5zcGxhc2guY29tOzs7Ozs%3D')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Search Engine</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        
                            2017-10-29
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/Algorithm/">#Algorithm</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h1 id="Search-Engine"><a href="#Search-Engine" class="headerlink" title="Search Engine"></a>Search Engine</h1><hr>
<p>Implement the simplified Search Engine for the pages of a small Web site. Use all the words in the pages of the site as index terms, excluding stop words such as articles, prepositions, and pronouns.</p>
<p>The World Wide Web contains a huge collection of text documents (web pages). Information about these pages is gathered by a program called a <strong>web crawler</strong>, which then stores this information in a special dictionary database. A web <strong>search engine</strong> allows users to retrieve relevant information from this database, thereby identifying relevant pages on the web containing given keywords. In this section, we present a simplified model of a search engine.</p>
<h2 id="Inverted-Files"><a href="#Inverted-Files" class="headerlink" title="Inverted Files"></a>Inverted Files</h2><hr>
<p>The core information stored by a search engine is a dictionary, called an <strong>inverted index</strong> or <strong>inverted file</strong>, storing key-value pairs (w,L), where w is a word and L is a collection of references to pages containing word w. The keys (words) in<br>this dictionary are called <strong>index terms</strong> and should be a set of vocabulary entries and proper nouns as large as possible. The elements in this dictionary are called occurrence lists and should cover as many web pages as possible.<br>We can efficiently implement an inverted index with a data structure consisting of the following:</p>
<ul>
<li>An array storing the occurrence lists of the terms (in no particular order)</li>
<li>A compressed trie for the set of index terms, where each external node stores the index of the occurrence list of the associated term.</li>
</ul>
<p>The reason for storing the occurrence lists outside the trie is to keep the size of the trie data structure sufficiently small to fit in internal memory. Instead, because of their large total size, the occurrence lists have to be stored on disk.</p>
<p>With our data structure, a query for a single keyword is similar to a word matching query. Namely, we find the keyword in the trie and we return the associated occurrence list.</p>
<p>When multiple keywords are given and the desired output is the pages containing all the given keywords, we retrieve the occurrence list of each keyword using the trie and return their intersection. To facilitate the intersection computation, each occurrence list should be implemented with a sequence sorted by address or with a dictionary, which allows for a simple intersection algorithm similar to sorted sequence merging.</p>
<p>In addition to the basic task of returning a list of pages containing given keywords, search engines provide an important additional service by ranking the pages returned by relevance. Devising fast and accurate <strong>ranking</strong> algorithms for search<br>engines is a major challenge for computer researchers and electronic commerce companies.</p>
<h2 id="Trie"><a href="#Trie" class="headerlink" title="Trie"></a>Trie</h2><hr>
<p><a href="https://en.wikipedia.org/wiki/Trie" target="_blank" rel="external">Trie</a>: Naïve brute force for searching a text of size n and a pattern of size m requires significant computing time. Preprocessing the pattern speeds up pattern matching queries. A trie is a compact data structure for representing a set of strings, such as all the words in a text. A trie supports pattern matching queries in time proportional to the pattern size.</p>
<h3 id="Standard-Tries"><a href="#Standard-Tries" class="headerlink" title="Standard Tries"></a>Standard Tries</h3><hr>
<p>The standard trie for a set of strings S is an ordered tree such that:</p>
<ul>
<li>Each node but the root is labeled with a character</li>
<li>The children of a node are alphabetically ordered</li>
<li>The paths from the root to the leaves yield the strings of S</li>
</ul>
<p>Example: set of strings S = { bear, bell, bid, bull, buy, sell, stock, stop }<br><img src="../images/trie.png" alt="trie"></p>
<hr>
<h2 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation"></a>Implementation</h2><p>Using javascript to implement search engine project. I program in ES6 with Node.js version 6.1.0. The specific external dependencies I used has been saved to my package.json folder.<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">"dependencies": &#123;</div><div class="line">    "fs": "0.0.1-security",</div><div class="line">    "readline": "^1.3.0",</div><div class="line">    "stopword": "^0.1.1"</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>In this search engine, there are several function for it:<br><strong>readFile()</strong>, read given input file and according to the page names, read the page files and return an array which contain all the words for each page.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">readFile = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> filename = <span class="string">"input.txt"</span>;</div><div class="line">    <span class="keyword">let</span> input;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        input = fs.readFileSync(filename, <span class="string">'utf8'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">catch</span> (err) &#123;</div><div class="line">        <span class="built_in">console</span>.error(<span class="string">'\nERROR!: no such file or directory, open\''</span> + filename + <span class="string">'\'!! Please try again!!\n'</span>);</div><div class="line">        process.exit(<span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> webPagesArray = input.split(<span class="string">'\n'</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; webPagesArray.length; i++) &#123;</div><div class="line">        <span class="keyword">if</span> (webPagesArray[i] == <span class="string">""</span>) &#123;</div><div class="line">            webPagesArray.splice(i, <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (webPagesArray[i][webPagesArray[i].length - <span class="number">1</span>] == <span class="string">'\r'</span>) &#123;</div><div class="line">            webPagesArray[i] = webPagesArray[i].substring(<span class="number">0</span>, webPagesArray[i].length - <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        webPagesContent = fs.readFileSync(webPagesArray[i], <span class="string">'utf8'</span>);</div><div class="line">        stringifiedWebPagesContent = stringify(webPagesContent);</div><div class="line">        webPagesArray[i] = &#123;</div><div class="line">            webPagesName : webPagesArray[i],</div><div class="line">            webPagesContent : stringifiedWebPagesContent </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> webPagesArray;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>invertIndex(webPagesArray)</strong>, according to the web pages array which contain all the words for each page, implement an inverted index.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//implement an inverted index with data structure that the key is word and value is the occurence times of this word in appeared pages </span></div><div class="line"><span class="comment">//data structure is &#123;word: [pageName: occurence times in this page for this word]&#125;</span></div><div class="line">invertIndex = <span class="function">(<span class="params">webPagesArray</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> invertedIndex = &#123;&#125;;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; webPagesArray.length; i++) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; webPagesArray[i].webPagesContent.length; j++) &#123;</div><div class="line">            <span class="keyword">if</span> (!invertedIndex[webPagesArray[i].webPagesContent[j]]) &#123;</div><div class="line">                <span class="comment">//invertedIndex[webPagesArray[i].webPagesContent[j]] = [webPagesArray[i].webPagesName];</span></div><div class="line">                invertedIndex[webPagesArray[i].webPagesContent[j]] = [];</div><div class="line">                invertedIndex[webPagesArray[i].webPagesContent[j]][webPagesArray[i].webPagesName] = <span class="number">1</span>;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="comment">//invertedIndex[webPagesArray[i].webPagesContent[j]].push(webPagesArray[i].webPagesName);</span></div><div class="line">                <span class="keyword">if</span> (!invertedIndex[webPagesArray[i].webPagesContent[j]][webPagesArray[i].webPagesName]) &#123;</div><div class="line">                    invertedIndex[webPagesArray[i].webPagesContent[j]][webPagesArray[i].webPagesName] = <span class="number">1</span>;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    invertedIndex[webPagesArray[i].webPagesContent[j]][webPagesArray[i].webPagesName]++;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> invertedIndex;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>stringify(text)</strong>, remove stop words, convert the text to lowercase, remove all non-alphanumeric characters (? . ! ‘ , “ and so on), Convert all white space to simple spaces (new lines become spaces; tabs become spaces, etc).<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//simplify the text content</span></div><div class="line">stringify = <span class="function">(<span class="params">text</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> stopword = <span class="built_in">require</span>(<span class="string">'stopword'</span>); </div><div class="line">    <span class="keyword">let</span> textToLowerCase = text.toLowerCase(); </div><div class="line">    <span class="keyword">let</span> removeNonAlpha = textToLowerCase.replace(<span class="regexp">/[^A-Za-z0-9\t\s]/g</span>, <span class="string">''</span>);</div><div class="line">    <span class="keyword">let</span> removeSpace = removeNonAlpha.replace(<span class="regexp">/\s\s+/g</span>, <span class="string">' '</span>);</div><div class="line">    <span class="keyword">let</span> removeStopwords = stopword.removeStopwords(removeSpace.split(<span class="string">' '</span>));</div><div class="line"></div><div class="line">    <span class="keyword">return</span> removeStopwords;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>Trie(invertedIndex)</strong>, compressTrie(cur), findTrieWord(word, cur), according to the inverted index, store words in a trie as our dictionary and then compress the trie structure, and search given keyword in the trie.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//build a Trie</span></div><div class="line">Trie = <span class="function">(<span class="params">invertedIndex</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> trie = &#123;&#125;;</div><div class="line">    <span class="keyword">let</span> words = [];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> k <span class="keyword">in</span> invertedIndex) &#123;</div><div class="line">        words.push(k);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// Go through all the words in the dictionary</span></div><div class="line">    <span class="keyword">for</span> ( <span class="keyword">let</span> i = <span class="number">0</span>, l = words.length; i &lt; l; i++ ) &#123;</div><div class="line">        <span class="keyword">let</span> word = words[i], letters = word.split(<span class="string">""</span>), cur = trie;</div><div class="line">        <span class="keyword">for</span> ( <span class="keyword">let</span> j = <span class="number">0</span>; j &lt; letters.length; j++ ) &#123;</div><div class="line">            <span class="keyword">let</span> letter = letters[j], pos = cur[ letter ];</div><div class="line">    </div><div class="line">            <span class="comment">// If nothing exists for this letter, create a leaf</span></div><div class="line">            <span class="keyword">if</span> ( pos == <span class="literal">null</span> ) &#123;</div><div class="line">                cur = cur[ letter ] = j === letters.length - <span class="number">1</span> ? <span class="number">0</span> : &#123;&#125;;<span class="comment">// If it's the end of the word, set a 0, otherwise make an object so we can continue</span></div><div class="line">            </div><div class="line">            <span class="comment">// If a final leaf already exists we need to turn it into an object to continue traversing</span></div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( pos === <span class="number">0</span> ) &#123;</div><div class="line">                cur = cur[ letter ] = &#123; <span class="attr">$</span>: <span class="number">0</span> &#125;;</div><div class="line">            <span class="comment">// Otherwise there is nothing to be set, so continue on</span></div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                cur = cur[ letter ];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    compressTrie( trie );</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> trie;   </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// compress a Trie structure</span></div><div class="line">compressTrie = <span class="function">(<span class="params">cur</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> num = <span class="number">0</span>;</div><div class="line"> </div><div class="line">    <span class="comment">// Go through all the leaves in this branch</span></div><div class="line">    <span class="keyword">for</span> ( <span class="keyword">var</span> node <span class="keyword">in</span> cur ) &#123;</div><div class="line">        <span class="keyword">if</span> ( <span class="keyword">typeof</span> cur[ node ] === <span class="string">"object"</span> ) &#123;</div><div class="line">            <span class="keyword">let</span> ret = compressTrie( cur[ node ] );<span class="comment">// Continue compress even deeper</span></div><div class="line"> </div><div class="line">            <span class="comment">// The child leaf only had one child</span></div><div class="line">            <span class="comment">// and was "compressed" as a result</span></div><div class="line">            <span class="keyword">if</span> ( ret ) &#123;</div><div class="line">                <span class="keyword">delete</span> cur[ node ];<span class="comment">// Thus remove the current leaf</span></div><div class="line">               </div><div class="line">                node = node + ret.name;<span class="comment">// Remember the new name</span></div><div class="line">            </div><div class="line">                cur[ node ] = ret.value;<span class="comment">// Replace it with the revised one</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        num++;<span class="comment">// Keep track of how many leaf nodes there are</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// If only one leaf is present, compress it</span></div><div class="line">    <span class="keyword">if</span> ( num === <span class="number">1</span> ) &#123;</div><div class="line">        <span class="keyword">return</span> &#123; <span class="attr">name</span>: node, <span class="attr">value</span>: cur[ node ] &#125;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//search given keywod in the trie</span></div><div class="line">findTrieWord = <span class="function">(<span class="params"> word, cur </span>) =&gt;</span> &#123;</div><div class="line">    <span class="comment">// Get the root to start from</span></div><div class="line">    <span class="keyword">let</span> dict;</div><div class="line">    cur = cur || dict;</div><div class="line">   </div><div class="line">    <span class="comment">// Go through every leaf</span></div><div class="line">    <span class="keyword">for</span> ( <span class="keyword">let</span> node <span class="keyword">in</span> cur ) &#123;</div><div class="line">        <span class="keyword">if</span> ( word.indexOf( node ) === <span class="number">0</span> ) &#123;</div><div class="line">            <span class="keyword">let</span> val = <span class="keyword">typeof</span> cur[ node ] === <span class="string">"number"</span> &amp;&amp; cur[ node ] ?</div><div class="line">                dict.$[ cur[ node ] ] :<span class="comment">// Substitute in the removed suffix object</span></div><div class="line"> </div><div class="line">                cur[ node ];<span class="comment">// Otherwise use the current value</span></div><div class="line"> </div><div class="line">            <span class="keyword">if</span> ( node.length === word.length ) &#123;</div><div class="line">                <span class="keyword">return</span> val === <span class="number">0</span> || val.$ === <span class="number">0</span>;</div><div class="line"></div><div class="line">            <span class="comment">// Otherwise continue traversing deeper</span></div><div class="line">            <span class="comment">// down the tree until we find a match</span></div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> findTrieWord( word.slice( node.length ), val );</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">   </div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>pageRank(pages)</strong>, according to the occurrence of given keywords, sort the page descending.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">pageRank = <span class="function">(<span class="params">pages</span>) =&gt;</span> &#123;</div><div class="line">    <span class="comment">//build an Array to store the pageName and its total occurence times of each keyword</span></div><div class="line">    <span class="keyword">let</span> pageRankArr = [];</div><div class="line">    <span class="keyword">for</span> (page <span class="keyword">in</span> pages) &#123;</div><div class="line">        <span class="keyword">let</span> count = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (word <span class="keyword">in</span> pages[page]) &#123;</div><div class="line">            count += pages[page][word];</div><div class="line">        &#125;</div><div class="line">        pageRankArr.push(&#123;</div><div class="line">                pageName: page,</div><div class="line">                pageRankNum: count</div><div class="line">            &#125;);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//use bubble sort algorithm to sort the page descending</span></div><div class="line">    <span class="keyword">let</span> flag=<span class="literal">false</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; pageRankArr.length - <span class="number">1</span>; i++) &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; pageRankArr.length - <span class="number">1</span> - i; j++)&#123;</div><div class="line">            <span class="keyword">if</span>(pageRankArr[j].pageRankNum &lt; pageRankArr[j+<span class="number">1</span>].pageRankNum)&#123;</div><div class="line">                <span class="keyword">let</span> temp = pageRankArr[j];</div><div class="line">                pageRankArr[j] = pageRankArr[j+<span class="number">1</span>];</div><div class="line">                pageRankArr[j+<span class="number">1</span>] = temp;</div><div class="line">                flag = <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (flag) &#123;</div><div class="line">            flag = <span class="literal">false</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> pageRankArr;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>searchEngine(words)</strong>, implement searching function and return pageRankResult, which store the pageName and its total occurrence times of each keyword.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//implement searching function and return pageRankResult, an Array, which store the pageName and its total occurence times of each keyword </span></div><div class="line"><span class="comment">// data structure is [&#123;pageName: , pageRankNum: &#125;]</span></div><div class="line">searchEngine = <span class="function">(<span class="params">words</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> webPagesArray = readFile();</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> invertedIndex = invertIndex(webPagesArray);</div><div class="line"></div><div class="line">    <span class="keyword">let</span> trie = Trie(invertedIndex);</div><div class="line"></div><div class="line">    <span class="comment">//build pageResult to store the search result which key is pageName and value is the occurence times of each given keywword in this page</span></div><div class="line">    <span class="comment">//data structure is &#123;pageName: [word: occurence times of this word in this page]&#125;</span></div><div class="line">    <span class="keyword">let</span> searchWords = words.split(<span class="string">' '</span>);</div><div class="line">    <span class="keyword">let</span> wordResult = &#123;&#125;;</div><div class="line">    <span class="keyword">let</span> pageResult = &#123;&#125;;</div><div class="line">    </div><div class="line">    searchWords.forEach(<span class="function">(<span class="params">word</span>) =&gt;</span> &#123;</div><div class="line">        word = word.toLowerCase();</div><div class="line">        <span class="keyword">let</span> findResult = findTrieWord(word, trie);</div><div class="line">        <span class="keyword">if</span> (findResult === <span class="literal">true</span>) &#123;</div><div class="line">            wordResult[word] = (invertedIndex[word]);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> k <span class="keyword">in</span> wordResult[word]) &#123;</div><div class="line">                <span class="keyword">if</span> (pageResult[k] == <span class="literal">undefined</span>)</div><div class="line">                    pageResult[k] = [];</div><div class="line">                pageResult[k][word] = wordResult[word][k];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="comment">//build pages to store pages containing all the given keywords which key is pageName and value is the occurence times of each given keywword in this page</span></div><div class="line">    <span class="keyword">let</span> pages = &#123;&#125;;</div><div class="line">    <span class="keyword">for</span> (page <span class="keyword">in</span> pageResult) &#123;</div><div class="line">        <span class="keyword">let</span> count = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (word <span class="keyword">in</span> pageResult[page]) &#123;</div><div class="line">            count++;</div><div class="line">        &#125; </div><div class="line"></div><div class="line">        <span class="keyword">if</span> (count == searchWords.length) &#123;</div><div class="line">            pages[page] = pageResult[page];</div><div class="line">        &#125;  </div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//if pages = null, return -1</span></div><div class="line">    <span class="keyword">let</span> index = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (page <span class="keyword">in</span> pages) &#123;</div><div class="line">        index++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> pages;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>The execute process:</p>
<ol>
<li>Prompt user to input keywords to search for. </li>
<li>Read input file and then read the words in pages and then store them to webPagesArray.</li>
<li>According to the webPagesArray, generate inverted index.</li>
<li>Store words in a trie, and compress the trie structure.</li>
<li>For each given keywords, find the keyword in the trie and if it appears in the trie return pageResult which store the search result.</li>
<li>According to the pageResult, for each page, if it contain all the given keywords, return this page. Otherwise, return -1.</li>
<li>Call pageRank function, sort pages descending by the occurrence of keywords in this page.</li>
<li>If searchResult equals to -1, print no such result. Else, print the results by the pageRankResult, and write the results to output file.</li>
</ol>


                
                    <!-- Go to www.addthis.com/dashboard to customize your tools -->
                    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-59f638dd2142a8ba"></script>

                    <!-- Go to www.addthis.com/dashboard to customize your tools -->
                    <div class="addthis_sharing_toolbox"></div>
                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    
    <hr />
    <h3>Comments:</h3>
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>



                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                        <li>
                            <a href="https://twitter.com/CountryMonsters" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://www.facebook.com/profile.php?id=100004769733596" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://github.com/shaohuashang3" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://www.linkedin.com/in/shaohua-shang-15b395149/" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="mailto:shaohuashang3@gmail.com" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2017 Shaohua Shang<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
                
                <p class="copyright text-muted">Requests: <span id="busuanzi_value_site_pv"></span> , Visitors: <span id="busuanzi_value_site_uv"></span> , Views: <span id="busuanzi_value_page_pv"></span> </p>
                
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'www-shaohuashang-com';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



</body>

</html>